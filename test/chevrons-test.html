<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chevron Tabs — CSS (left cap + no seams)</title>
<style>
  :root{
    --h: 56px;        /* nav height (use an even px) */
    --tip: 22px;      /* right/left tip width */
    --left-cap: 10px; /* flat lead-in on the very left of the first tab */
    --fudge: 1px;     /* anti-gap oversize to hide hairlines */

    --brand: #2e7df6; /* active fill */
    --hover: #eaf2ff; /* hover fill for inactive */
    --muted: #5a6b82; /* inactive text */
    --body:  #f7f9fc; /* page bg */
  }

  html, body { margin:0; padding:0; background:var(--body);
    font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }
  .wrap { max-width:1100px; margin:24px auto; padding:0 16px; }

  /* -------- NAV (separate so nothing clips the left tip) -------- */
  .chevron-nav {
    display:flex;
    align-items:stretch;
    height:var(--h);
    overflow:visible; /* allow tips to extend */
    gap:0;
    background:transparent;
  }

  .tab {
    --fill: #fff;
    --text: var(--muted);
    position:relative;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:0 18px;
    min-width:120px;
    height:100%;
    flex:1 1 0;
    background:var(--fill);
    color:var(--text);
    font-weight:600;
    border:0;
    cursor:pointer;
    margin-left: calc(var(--tip) * -1);  /* overlap to hide seams */
    outline:none;
    line-height:1.2;
    text-align:center;
  }
  .tab:first-child { margin-left:0; }

  .tab.is-active { --fill: var(--brand); --text:#fff; }
  .tab:not(.is-active):hover { --fill: var(--hover); }

  /* Ensure pseudo-elements sit above the cap rectangle */
  .tab::before, .tab::after { position:absolute; z-index:2; content:""; }

  /* Right chevron tip for all but the last (oversized by --fudge to kill hairlines) */
  .tab::after{
    top: calc(-1 * var(--fudge));
    right: calc(var(--tip) * -1);
    width:0; height:0;
    border-top: calc(var(--h)/2 + var(--fudge)) solid transparent;
    border-bottom: calc(var(--h)/2 + var(--fudge)) solid transparent;
    border-left: var(--tip) solid var(--fill);
  }
  .tab:last-child::after { display:none; }

  /* ---------- FIRST TAB: flat left start + true left arrow ---------- */

  /* Flat lead-in block at the very left (gives a horizontal start) */
  .tab:first-child .cap{
    position:absolute; z-index:1;
    left: calc(var(--tip) * -1 - var(--left-cap));
    top: calc(-1 * var(--fudge));
    width: var(--left-cap);
    height: calc(var(--h) + 2 * var(--fudge));
    background: var(--fill);
    pointer-events:none;
    content:"";
  }

  /* Left-pointing triangle (comes immediately after the flat section) */
  .tab:first-child::before{
    left: calc(var(--tip) * -1);
    top: calc(-1 * var(--fudge));
    width:0; height:0;
    border-top: calc(var(--h)/2 + var(--fudge)) solid transparent;
    border-bottom: calc(var(--h)/2 + var(--fudge)) solid transparent;
    border-right: var(--tip) solid var(--fill);
  }

  /* Accessibility focus */
  .tab:focus-visible{ outline:3px solid #94b8ff; outline-offset:2px; }

  /* -------- PANELS (rounded box is separate; no clipping issues) -------- */
  .tabs-box{
    margin-top:8px;
    background:#fff;
    border:2px solid var(--brand);
    border-radius:10px;
    overflow:hidden;
  }
  .panels{ padding:16px; background:var(--body); border-top:1px solid var(--brand); }
  .panel{ display:none; }
  .panel.active{ display:block; }

  /* Mobile */
  @media (max-width:560px){
    :root { --h: 64px; --tip: 18px; --left-cap: 8px; }
    .tab { min-width:100px; padding:0 12px; font-size:14px; }
  }
</style>
</head>
<body>
<div class="wrap">
  <h2>Road Safety Audit Stages — CSS chevrons (flat start + no seams)</h2>

  <!-- Chevron nav -->
  <div id="chevronNav" class="chevron-nav" role="tablist" aria-label="RSA stages tabs">
    <button class="tab is-active" role="tab" id="t0" aria-selected="true" aria-controls="p0">
      <span class="label">Interim</span>
      <span class="cap" aria-hidden="true"></span> <!-- flat start -->
    </button>
    <button class="tab" role="tab" id="t1" aria-selected="false" aria-controls="p1">
      <span class="label">Stage 1</span>
    </button>
    <button class="tab" role="tab" id="t2" aria-selected="false" aria-controls="p2">
      <span class="label">Stage 2<br>&amp; Combined Stage 1–2</span>
    </button>
    <button class="tab" role="tab" id="t3" aria-selected="false" aria-controls="p3">
      <span class="label">Stage 3</span>
    </button>
    <button class="tab" role="tab" id="t4" aria-selected="false" aria-controls="p4">
      <span class="label">Stage 4</span>
    </button>
  </div>

  <div class="tabs-box">
    <div class="panels" id="panels">
      <section id="p0" class="panel active" role="tabpanel" aria-labelledby="t0">
        <h3>Interim Road Safety Audit</h3><p>Interim content…</p>
      </section>
      <section id="p1" class="panel" role="tabpanel" aria-labelledby="t1">
        <h3>Stage 1 Road Safety Audit</h3><p>Stage 1 content…</p>
      </section>
      <section id="p2" class="panel" role="tabpanel" aria-labelledby="t2">
        <h3>Stage 2 &amp; Combined Stage 1–2</h3><p>Stage 2 + Combined content…</p>
      </section>
      <section id="p3" class="panel" role="tabpanel" aria-labelledby="t3">
        <h3>Stage 3 Road Safety Audit</h3><p>Stage 3 content…</p>
      </section>
      <section id="p4" class="panel" role="tabpanel" aria-labelledby="t4">
        <h3>Stage 4 Road Safety Audit</h3><p>Stage 4 content…</p>
      </section>
    </div>
  </div>
</div>

<script>
(function(){
  const tabs   = Array.from(document.querySelectorAll('.tab'));
  const panels = Array.from(document.querySelectorAll('.panel'));

  // Ensure left tabs paint on top (hides seams reliably)
  tabs.forEach((t, i) => t.style.zIndex = String(1000 - i));

  function activate(idx){
    tabs.forEach((t,i)=>{
      const on = i===idx;
      t.classList.toggle('is-active', on);
      t.setAttribute('aria-selected', on ? 'true':'false');
      t.setAttribute('tabindex', on ? '0':'-1');
    });
    panels.forEach((p,i)=>{
      const on = i===idx;
      p.classList.toggle('active', on);
      p.setAttribute('aria-hidden', on ? 'false':'true');
    });
    tabs[idx].focus({preventScroll:true});
  }

  tabs.forEach((t,i)=>{
    t.addEventListener('click', ()=> activate(i));
    t.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); activate(i); }
      if(e.key === 'ArrowRight' || e.key === 'ArrowLeft'){
        e.preventDefault();
        const dir = e.key === 'ArrowRight' ? 1 : -1;
        const next = (i + dir + tabs.length) % tabs.length;
        activate(next);
      }
    });
  });

  // Init
  tabs.forEach((t,i)=> t.setAttribute('tabindex', i===0 ? '0':'-1'));
})();
</script>
</body>
</html>
